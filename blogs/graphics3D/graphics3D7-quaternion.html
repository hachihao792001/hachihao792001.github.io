<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@200&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/blogcontent.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="stylesheet" href="graphics3D.css">

    <script src="/js/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <title>Graphics Engine 3D</title>
</head>

<body data-graphics3D-id="graphics3D7">
    <main>
        <div class="container-fluid ps-0">
            <div class="row">
                <div class="col-12 col-lg-2 sidebar pb-0 pe-0">
                    <!--load from sidebar.html-->
                </div>

                <div class="blog-content col-12 col-lg-10">
                    <div id="graphics3D-nav-top"></div>
                    <h1>Quaternion</h1>

                    Blog tr∆∞·ªõc m√¨nh v·ª´a n√≥i l√† ngh·ªâ m·ªôt ch√∫t sau c√°c blog n·∫∑ng v·ªÅ to√°n, nh∆∞ng blog n√†y s·∫Ω l√† blog n·∫∑ng v·ªÅ to√°n nh·∫•t trong series n√†y ü•µ<br/><br/>
                    <h2>1. L√≠ do</h2>
                    ·ªû blog <a href="graphics3D5-model.html">Model Matrix</a> m√¨nh ƒë√£ c√πng nhau t√¨m ƒë∆∞·ª£c 3 rotation matrix cho 3 tr·ª•c trong kh√¥ng gian, th·∫≠t ra ph√©p
                    xoay nh∆∞ v·∫≠y ƒë∆∞·ª£c g·ªçi l√† Euler rotation v√† nh·ªØng g√≥c xoay ƒë√≥ ƒë∆∞·ª£c g·ªçi l√† <a href="https://en.wikipedia.org/wiki/Euler_angles">Euler angles</a>.
                    Nh∆∞ng Euler angles c√≥ nhi·ªÅu ƒëi·ªÉm b·∫•t c·∫≠p, ƒëi·ªÉm b·∫•t c·∫≠p l·ªõn nh·∫•t l√† n√≥ s·∫Ω b·ªã <a href="https://en.wikipedia.org/wiki/Gimbal_lock">Gimbal lock</a>,
                    l√† hi·ªán t∆∞·ª£ng l√† khi b·∫°n xoay 1 tr·ª•c n√†o ƒë√≥ l√†m cho 2 tr·ª•c c√≤n l·∫°i "song song" v·ªõi nhau, d·∫´n t·ªõi k·∫øt qu·∫£ c·ªßa vi·ªác xoay 2 tr·ª•c ƒë√≥ gi·ªëng y h·ªát nhau.
                    B·∫°n c√≥ th·ªÉ xem gif n√†y c·ªßa Wiki ƒë·ªÉ hi·ªÉu r√µ h∆°n:
                    <div align="center">
                        <a href="https://en.wikipedia.org/wiki/Gimbal_lock#/media/File:Gimbal_Lock_Plane.gif">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/4/49/Gimbal_Lock_Plane.gif"/></a>
                    </div>
                    S·ª≠ d·ª•ng Quaternion s·∫Ω gi·∫£i quy·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ n√†y, c√≤n t·∫°i sao th√¨ m√¨nh kh√¥ng hi·ªÉu ƒë·ªß b·∫£n ch·∫•t c·ªßa n√≥ ƒë·ªÉ hi·ªÉu üòÖ m√¨nh ch·ªâ hi·ªÉu t·∫°i sao c√°c t√≠nh ch·∫•t
                    ƒë·∫°i s·ªë c·ªßa n√≥ l·∫°i li√™n quan t·ªõi vi·ªác xoay trong 3D. N·∫øu b·∫°n x√†i qua Unity th√¨ ch·∫Øc c≈©ng g·∫∑p qua n√≥, v√† c≈©ng ƒë∆∞·ª£c khuy√™n l√† ƒë·ª´ng n√™n t√¨m hi·ªÉu qu√° s√¢u m√†
                    ch·ªâ n√™n bi·∫øt c√°ch d√πng n√≥, nh∆∞ng m√† ·ªü ƒë√¢y m√¨nh ƒëang vi·∫øt m·ªôt th·ª© g·∫ßn gi·ªëng nh∆∞ Game engine n√™n c√†i ƒë·∫∑t ƒë∆∞·ª£c n√≥ l√† ƒëi·ªÅu t·∫•t y·∫øu.<br/><br/>
                    <h2>2. ƒê·ªãnh nghƒ©a v√† c√†i ƒë·∫∑t</h2>
                    N·∫øu b·∫°n l∆∞·ªõt qua th·ª≠ blog n√†y v√† th·∫•y s·ªë l∆∞·ª£ng c√¥ng th·ª©c l√†m b·∫°n overwhelm, b·∫°n c√≥ th·ªÉ d·ª´ng sau khi xong ph·∫ßn n√†y, ph·∫ßn n√†y m√¨nh ch·ªâ n√≥i cho b·∫°n bi·∫øt nh·ªØng
                    th·ª© c·ªët l√µi nh·∫•t ƒë·ªÉ c√†i ƒë·∫∑t ƒë∆∞·ª£c Quaternion v√†o engine üò≥<br/><br/>

                    Quaternion c√≥ 3 c√°ch bi·ªÉu di·ªÖn (3 "ƒë·ªãnh nghƒ©a"):
                    <ol>
                        <li>\((a, b, c, d)\). C√°ch bi·ªÉu di·ªÖn n√†y b·∫°n c√≥ th·ªÉ hi·ªÉu n√≥ l√† vector 4 chi·ªÅu</li>
                        <li>\(a + bi + cj + dk\). C√°ch bi·ªÉu di·ªÖn n√†y b·∫°n c√≥ th·ªÉ hi·ªÉu n√≥ l√† "s·ªë ph·ª©c nh∆∞ng c√≥ th√™m \(j\) v√† \(k\)"</li>
                        <li>\(a + v\). Trong ƒë√≥ \(a\) l√† m·ªôt s·ªë th·ª±c (ph·∫ßn scalar), v√† \(v = (b, c, d)\) l√† m·ªôt vector (ph·∫ßn vector). C√°ch bi·ªÉu di·ªÖn n√†y ƒë∆∞·ª£c 
                        g·ªçi l√† bi·ªÉu di·ªÖn Scalar-vector, nh√¨n m·ªôt s·ªë c·ªông m·ªôt vector kh√° l√† v√¥ nghƒ©a nh∆∞ng ta v·ª´a ƒë·ªãnh nghƒ©a n√≥, k·∫øt qu·∫£ c·ªßa ph√©p 
                        c·ªông m·ªôt s·ªë v·ªõi m·ªôt vector l√† m·ªôt Quaternion üò≥.</li>
                    </ol>

                    V·ªõi d·∫°ng ƒë·∫ßu ti√™n, n√≥ c≈©ng c√≥ nh·ªØng t√≠nh ch·∫•t ƒë·∫°i s·ªë c·ªßa vector 4 chi·ªÅu, ƒëi·ªÉn h√¨nh nh∆∞ ph√©p c·ªông, tr·ª´ v√† nh√¢n h·∫±ng s·ªë:
                    $$
                    (a,b,c,d)\pm(e,f,g,h) = (a\pm e,b\pm f,c\pm g,d\pm h)
                    $$
                    $$
                    k\cdot(a,b,c,d) = (ka,kb,kc,kd)
                    $$
                    ·ªû d·∫°ng th·ª© hai \(a + bi + cj + dk\), \(a\) th·∫≠t ra ƒëang nh√¢n v·ªõi s·ªë \(1\) (nh∆∞ng s·ªë g√¨ nh√¢n \(1\) c≈©ng b·∫±ng ch√≠nh n√≥ n√™n kh√¥ng ghi), 
                    s·ªë \(1\) c≈©ng c√≥ th·ªÉ ƒë∆∞·ª£c xem l√† Quaternion v·ªõi d·∫°ng \((1,0,0,0)\). ƒêi·ªÅu n√†y c≈©ng ƒë√∫ng v·ªõi m·ªçi s·ªë th·ª±c. Ngo√†i ra, ta c√≥ ƒë·ªãnh nghƒ©a c·ªßa \(i,j,k\)
                    $$
                    \begin{eqnarray} 
                    i = (0,1,0,0) \\
                    j = (0,0,1,0) \\
                    k = (0,0,0,1)
                    \end{eqnarray}
                    $$
                    
                    K·∫øt qu·∫£ ph√©p nh√¢n 2 Quaternion (n·∫øu b·∫°n mu·ªën bi·∫øt t·∫°i sao n√≥ ra v·∫≠y th√¨ h√£y ƒë·ªçc ti·∫øp sau ph·∫ßn n√†y):
                    $$
                    \begin{eqnarray}
                    (a,b,c,d) \cdot (w,x,y,z) = \\
                                    = (aw - bx - cy - dz, \\
                                    ax + bw + cz - dy, \\
                                    ay - bz + cw + dx, \\
                                    az + by - cx + dw)
                    \end{eqnarray}
                    $$
                    V·ªõi ph√©p nh√¢n, Quaternion kh√¥ng c√≥ t√≠nh ch·∫•t giao ho√°n (commutative), nh∆∞ng l·∫°i c√≥ t√≠nh ch·∫•t k·∫øt h·ª£p (associative):
                    $$
                    \begin{eqnarray}
                        p\cdot q \, \neq \, q\cdot p\\
                        p\cdot(q\cdot r) = (p\cdot q)\cdot r
                    \end{eqnarray}
                    $$
                    Ngo√†i ra, Quaternion c√≥ t√≠nh ph√¢n ph·ªëi (distributive):
                    $$
                    \begin{eqnarray}
                    p\cdot(q+s) = p\cdot q + p\cdot s \\
                    (q+s)\cdot p = q\cdot p + s\cdot p
                    \end{eqnarray}
                    $$
                    <div align="center" style="font-size: 14px;"> <i>2 bi·ªÉu th·ª©c tr√™n kh√°c nhau v√¨ ph√©p nh√¢n kh√¥ng c√≥ t√≠nh ch·∫•t giao ho√°n</i></div>
                    Ph·∫ßn li√™n h·ª£p (conjugate) c·ªßa Quaternion \(q=a+v\) c√≥ d·∫°ng sau:
                    $$
                        q^* = a - v
                    $$
                    <div align="center" style="font-size: 14px;"> <i>Xem r√µ h∆°n ·ªü ph·∫ßn 4</i></div>
                    <div style="color: red;"><i>N·∫øu b·∫°n ƒëang th·∫•y m√¨nh l∆∞·ªõt v√† ƒëi qu√° nhanh, v√¨ ƒë√∫ng l√† m√¨nh ƒëang l√†m v·∫≠y. ƒê√≥ l√† m·ª•c ƒë√≠ch c·ªßa ph·∫ßn n√†y, ch·ªâ gi√∫p b·∫°n c√†i ƒë·∫∑t nh∆∞ng b·ªè vi·ªác gi·∫£i th√≠ch l√≠ do c√°c 
                    th·ª©, b·∫°n s·∫Ω hi·ªÉu r√µ h∆°n n·∫øu b·∫°n ƒë·ªçc ti·∫øp t·ª´ ph·∫ßn 3 tr·ªü ƒëi.</i></div><br/>
                    Ta ƒë√£ xong ph·∫ßn "ƒë·ªãnh nghƒ©a v√† t√≠nh ch·∫•t", ta s·∫Ω t·ªõi ph·∫ßn ch√≠nh l√† quan h·ªá c·ªßa Quaternion v·ªõi xoay 3D. Bi·ªÉu th·ª©c sau ƒë·∫°i di·ªán cho m·ªôt ph√©p xoay 3D:
                    $$
                        pvp^*
                    $$
                    Trong ƒë√≥ \(v\) l√† m·ªôt Quaternion thu·∫ßn vector (c√≥ ph·∫ßn scalar = 0), c≈©ng c√≥ th·ªÉ hi·ªÉu n√≥ l√† m·ªôt vector. V√† \(p\) c√≥ d·∫°ng sau:
                    $$
                    p = \cos\frac{\theta}{2} - \sin\frac{\theta}{2}n
                    $$
                    Trong ƒë√≥ \(n\) l√† m·ªôt vector c√πng ph∆∞∆°ng c√πng chi·ªÅu v·ªõi tr·ª•c xoay c·ªßa ph√©p xoay, v√† \(\theta\) ch√≠nh l√† g√≥c xoay. Ph√©p xoay tr√™n c√≥ t√≠nh ch·∫•t:
                    $$
                        p(qvq^*)p^* = (pq)v(pq)^*
                    $$
                    Nghƒ©a l√† th·ª±c hi·ªán ph√©p xoay c·ªßa \(q\) r·ªìi \(p\) c≈©ng gi·ªëng nh∆∞ th·ª±c hi·ªán 1 ph√©p xoay \(pq\) v·∫≠y (l∆∞u √Ω l√† n√≥ ng∆∞·ª£c).<br/><br/>
                    Nh∆∞ v·∫≠y ta ƒë√£ c√≥ ƒë∆∞·ª£c m·ªçi th·ª© ta c·∫ßn, b·∫Øt ƒë·∫ßu c√†i ƒë·∫∑t üò≥ Class Quaternion c·ªßa ch√∫ng ta s·∫Ω kh√° ng·∫Øn:
                    <pre><code class="language-javascript">class Quaternion {
    constructor(a = 1, b = 0, c = 0, d = 0) {
        this.a = a;
        this.b = b;
        this.c = c;
        this.d = d;
    }

    static buildQuaternion(axis, angle) { // x√¢y d·ª±ng Quaternion theo d·∫°ng p = cos(Œ∏/2) - sin(Œ∏/2)n
        let radian = angle / 180.0 * Math.PI;
        const half = radian / 2;
        const s = -Math.sin(half);
        return new Quaternion(
            Math.cos(half),
            axis.x * s,
            axis.y * s,
            axis.z * s);
    }

    static multiply(p, q) { //nh√¢n 2 Quatenrion theo c√¥ng th·ª©c tr√™n
        let a = p.a * q.a - p.b * q.b - p.c * q.c - p.d * q.d;
        let b = p.a * q.b + p.b * q.a + p.c * q.d - p.d * q.c;
        let c = p.a * q.c - p.b * q.d + p.c * q.a + p.d * q.b;
        let d = p.a * q.d + p.b * q.c - p.c * q.b + p.d * q.a;
        return new Quaternion(a, b, c, d);
    }

    conjugate() {   //li√™n h·ª£p
        return new Quaternion(this.a, -this.b, -this.c, -this.d);
    }

    rotateVector(v) { //xoay vector b·∫±ng Quaternion n√†y, s·ª≠ d·ª•ng qvq*
        const qVec = new Quaternion(0, v.x, v.y, v.z);
        const res = Quaternion.multiply(Quaternion.multiply(this, qVec), this.conjugate());
        return new Vector3(
            res.b,
            res.c,
            res.d);
    }
    static RotateVectorAxisAngle(v, axis, angle) {   //xoay vector quanh tr·ª•c axis 1 g√≥c angle, s·ª≠ d·ª•ng axis v√† angle ƒë·ªÉ x√¢y d·ª±ng Quaternion v√† d√πng Quaternion ƒë√≥ ƒë·ªÉ xoay 
        let radian = angle / 180.0 * Math.PI;
        return buildQuaternion(axis, radian).rotateVector(v);
    }
}</code></pre>
                    C√°ch s·ª≠ d·ª•ng Quaternion v√†o vi·ªác xoay c≈©ng gi·ªëng nh∆∞ c√°ch ta s·ª≠ d·ª•ng Rotation matrix. ·ªû c√°ch Rotation matrix, ta kh√¥ng li√™n t·ª•c thay ƒë·ªïi t·ªça ƒë·ªô c·ªßa t·∫•t c·∫£
                    c√°c ƒë·ªânh c·ªßa object, m√† ch·ªâ thay ƒë·ªïi thu·ªôc t√≠nh rotation (l√† 1 euler angles) r·ªìi cu·ªëi m·ªói frame m·ªõi bi·∫øn n√≥ th√†nh rotation matrix v√† √°p d·ª•ng v√†o c√°c ƒë·ªânh.
                    B√¢y gi·ªù c≈©ng th·∫ø, nh∆∞ng thay v√¨ l∆∞u rotation l√† m·ªôt euler angles th√¨ ta l∆∞u n√≥ l√† m·ªôt Quaternion, m·ªói l·∫ßn ta mu·ªën xoay ta ch·ªâ c·∫ßn nh√¢n th√™m Quaternion xoay
                    ƒë√≥ v√†o trong Quaternion rotation ƒë√£ c√≥ s·∫µn, r·ªìi cu·ªëi m·ªói frame c·ª© l·∫•y Quaternion cu·ªëi c√πng ƒë√≥ √°p v√†o t·ª´ng ƒë·ªânh.<br/><br/>

                    Tr∆∞·ªõc khi ti·∫øp t·ª•c, c√≥ m·ªôt th·ª© m√† ƒë√°ng l·∫Ω m√¨nh ph·∫£i l√†m l√¢u r·ªìi, ƒë√≥ ch√≠nh l√† t·∫°o s·∫µn c√°c Vector3 th∆∞·ªùng d√πng nh∆∞ Unity ƒë·ªÉ code ƒë∆∞·ª£c clean:
                    <pre><code class="language-javascript">class Vector3 {
    ...

    static zero;
    static one;
    static left;
    static right;
    static up;
    static down;
    static forward;

    ...
}
Vector3.zero = new Vector3(0, 0, 0);
Vector3.one = new Vector3(1, 1, 1);
Vector3.left = new Vector3(-1, 0, 0);
Vector3.right = new Vector3(1, 0, 0);
Vector3.up = new Vector3(0, 1, 0);
Vector3.down = new Vector3(0, -1, 0);
Vector3.forward = new Vector3(0, 0, 1);</code></pre> 

                    Tr∆∞·ªõc ti√™n ta th√™m m·ªôt h√†m xoay theo Quaternion cho class Triangle (√°p d·ª•ng xoay cho 3 ƒë·ªânh c·ªßa n√≥):
                    <pre><code class="language-javascript">class Triangle {
    ...

    rotate(q) {
        for (let i = 0; i < this.vertices.length; i++) {
            this.vertices[i] = q.rotateVector(this.vertices[i]);
        }
    }

    ...
}</code></pre>
                    
                    ·ªû class Cube, ta ph·∫£i l√†m nh·ªØng th·ª© sau:
                    <ul>
                        <li>Thay ƒë·ªïi constructor ƒë·ªÉ chuy·ªÉn ki·ªÉu c·ªßa rotation th√†nh Quaternion, nh∆∞ng v·∫´n nh·∫≠n tham s·ªë l√† euler angles ƒë·ªÉ d·ªÖ hi·ªÉu. Ta s·∫Ω ph·∫£i d√πng
                    Quaternion ƒë·ªÉ xoay theo 3 tr·ª•c t∆∞∆°ng ·ª©ng, v√† xoay theo th·ª© t·ª± \(x \rightarrow y \rightarrow z\) nh∆∞ c√°ch rotation matrix, nh∆∞ng khi nh√¢n Quaternion ta ph·∫£i
                    nh√¢n ng∆∞·ª£c l·∫°i (ƒë√£ n√≥i ·ªü tr√™n).</li>
                        <li>Th√™m m·ªôt h√†m rotate (c≈©ng nh·∫≠n tham s·ªë l√† euler angles), ƒë·ªÉ √°p ph√©p xoay m·ªõi (nh√¢n Quaternion) v√†o rotation.</li>
                        <li>Thay ƒë·ªïi h√†m getTransformedTriangles, thay v√¨ nh√¢n 3 ma tr·∫≠n rotation matrix, ta ch·ªâ c·∫ßn 1 d√≤ng duy nh·∫•t l√† √°p d·ª•ng Quaternion rotation v√†o ƒë·ªânh hi·ªán t·∫°i</li>
                    </ul>
                    <pre><code class="language-javascript">class Cube {
    constructor(pos, eulerAngles, scale) {
        this.tris = [];
        this.pos = pos;
        this.scale = scale;

        let q = Quaternion.buildQuaternion(Vector3.forward, eulerAngles.z);
        q = Quaternion.multiply(q, Quaternion.buildQuaternion(Vector3.up, eulerAngles.y));
        q = Quaternion.multiply(q, Quaternion.buildQuaternion(Vector3.right, eulerAngles.x));
        this.rotation = q;

        this.generateInitialTriangles();
    }

    ...

    rotate(eulerX, eulerY, eulerZ) {
        let q = Quaternion.buildQuaternion(Vector3.forward, eulerZ);
        q = Quaternion.multiply(q, Quaternion.buildQuaternion(Vector3.up, eulerY));
        q = Quaternion.multiply(q, Quaternion.buildQuaternion(Vector3.right, eulerX));

        this.rotation = Quaternion.multiply(q, this.rotation);
    }
    
    ...

    getTransformedTriangles() {
        let transformedTris = [];
        for (let tri of this.tris) {
            let transformedTri = tri.clone();
            transformedTri.mulMat4x4(Mat4x4.Scale(this.scale.x, this.scale.y, this.scale.z));
            transformedTri.rotate(this.rotation);   // <--------------------------
            transformedTri.mulMat4x4(Mat4x4.Translation(this.pos.x, this.pos.y, this.pos.z));
            transformedTris.push(transformedTri);
        }
        return transformedTris;
    }
}
                    </code></pre>
                    <i>N·∫øu javascript c√≥ operator overloading th√¨ code s·∫Ω nh√¨n kh√° d·ªÖ ƒë·ªçc ch·ª© ko ph·∫£i h√†m l·ªìng h√†m nh∆∞ tr√™n ü•µ</i><br/><br/>
                    Cu·ªëi c√πng, ƒë·ªëi v·ªõi 2 cube, thay v√¨ d√πng rotation matrix ƒë·ªÉ xoay th√¨ ta d√πng h√†m rotate c·ªßa Cube:
                    <pre><code class="language-javascript">cube1.rotate(0, 50 * dt, 0);
cube2.rotate(50 * dt, 0, 50 * dt);</code></pre>
                    Full code, b·∫°n c√≥ th·ªÉ gi·ªØ l·∫°i 3 h√†m rotation matrix ·ªü class Mat4x4 n·∫øu mu·ªën, m√¨nh th√¨ b·ªè ƒëi cho code b·ªõt d√†i (c≈©ng ko b·ªõt m·∫•y):
                    <div class="htmlPreview" id="htmlPreview13"></div>
                    Nh∆∞ v·∫≠y l√† b·∫°n ƒë√£ c√†i ƒë·∫∑t ƒë∆∞·ª£c Quaternion v√†o engine c·ªßa m√¨nh, n·∫øu b·∫°n mu·ªën th√¨ c√≥ th·ªÉ ƒë·ªçc ti·∫øp blog ƒë·ªÉ xem c√°ch ch·ª©ng minh t·ª´ ƒë·∫ßu t·ªõi cu·ªëi sao cho ra
                    ƒë∆∞·ª£c ph√©p xoay 3D trong Quaternion.<br/><br/>
                    <h2>3. Ph√©p nh√¢n Quaternion</h2>
                    Tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu ph·∫ßn "ch·ª©ng minh m·ªçi th·ª©", m√¨nh mu·ªën n√≥i l√† nh·ªØng g√¨ m√¨nh vi·∫øt trong blog n√†y ƒë·ªÅu d·ª±a v√†o blog 
                    <a href="https://lisyarus.github.io/blog/posts/introduction-to-quaternions.html">(Yet another) Introduction to quaternions c·ªßa lisyarus</a>. B·∫°n c√≥ th·ªÉ
                    xem blog ƒë√≥ thay v√¨ blog c·ªßa m√¨nh n·∫øu mu·ªën hi·ªÉu s√¢u h∆°n, blog n√†y m√¨nh ch·ªâ n√≥i v·ªÅ nh·ªØng g√¨ m√¨nh th·∫≠t s·ª± th·∫•y c·∫ßn thi·∫øt, v√† ch·ª©ng minh r√µ th√™m m·ªôt s·ªë th·ª©.<br/><br/>

                    ƒê·ªëi v·ªõi ph√©p nh√¢n 2 Quaternion, ta th·ª≠ nh√¢n d·∫°ng s·ªë ph·ª©c c·ªßa n√≥ v√† tri·ªÉn khai ra:
                    $$
                    \begin{eqnarray} 
                    (a,b,c,d)\cdot(w,x,y,z) = (a+bi+cj+dk) \cdot (w+xi+yj+zk) = \\
                        = aw + ax\cdot i+ ay\cdot j+ az\cdot k+ \\
                        bw\cdot i + bx\cdot i^2 + by\cdot ij + bz\cdot ik + \\
                        cw\cdot j + cx\cdot ji +cy\cdot j^2 + cz\cdot jk +  \\
                        dw\cdot k + dx\cdot ki + dy\cdot kj + dz\cdot k^2
                    \end{eqnarray}
                    $$
                    Nh√¨n kh√° l√† r·ªëi, tuy nhi√™n ta c√≥ th·ªÉ ƒë∆°n gi·∫£n h√≥a n√≥ b·∫±ng c√°c lu·∫≠t sau c·ªßa Quaternion:
                    $$
                    \begin{eqnarray} 
                    i^2=j^2=k^2=-1\\
                    ij=-ji=k \\
                    jk=-kj=i\\
                    ki=-ik=j
                    \end{eqnarray}
                    $$
                    Sau khi √°p d·ª•ng c√°c lu·∫≠t tr√™n v√† tri·ªát ti√™u c√°c th·ª©, ta c√≥:
                    $$
                    \begin{eqnarray} 
                    aw + ax\cdot i+ ay\cdot j+ az\cdot k+ \\
                    bw\cdot i + bx\cdot i^2 + by\cdot ij + bz\cdot ik  \\
                    cw\cdot j + cx\cdot ji + cy\cdot j^2 + cz\cdot jk +  \\
                    dw\cdot k + dx\cdot ki + dy\cdot kj + dz\cdot k^2 = \\
                    = (aw - bx - cy - dz)\\
                    + (ax\cdot i + ay\cdot j + az\cdot k)\\
                    + (wb\cdot i + wc\cdot j + wd\cdot k)\\
                    + cz\cdot i - dy\cdot i + dx\cdot j - bz\cdot j + by\cdot k - cx\cdot k 
                    \end{eqnarray}
                    $$
                    <div align="center" style="font-size: 14px;"><i>N·∫øu b·∫°n gom theo \(i, j, k\), b·∫°n s·∫Ω ra l·∫°i k·∫øt qu·∫£ ph√©p nh√¢n m√† m√¨nh ghi ·ªü ph·∫ßn 2, nh∆∞ng m√¨nh kh√¥ng l√†m v·∫≠y v√¨ mu·ªën l√†m g·ªçn th√™m</i></div>
                    Nh√¨n c≈©ng kh√° r·ªëi v√† kh√≥ nh·ªõ, ta s·∫Ω ƒë∆°n gi·∫£n h√≥a n√≥ v·ªõi d·∫°ng bi·ªÉu di·ªÖn scalar-vector:
                    $$
                    (a + u)(w + v)
                    $$
                    v·ªõi \(u = (b, c, d), v = (x, y, z)\) <br/><br/>
                    Ta quay l·∫°i ph√©p nh√¢n ƒëang d·ªü ·ªü ph√≠a tr√™n:
                    $$          
                    \begin{eqnarray} 
                    (a + u)\cdot (w + v) = (a+bi+cj+dk) \cdot (w+xi+yj+zk) \\
                    = (aw - bx - cy - dz)\\
                    + (ax\cdot i + ay\cdot j + az\cdot k)\\
                    + (wb\cdot i + wc\cdot j + wd\cdot k)\\
                    + cz\cdot i - dy\cdot i + dx\cdot j - bz\cdot j + by\cdot k - cx\cdot k  \\
                    = [aw - (bx + cy + dz)] \\
                    + a\cdot v \\
                    + w\cdot u \\
                    + (cz-dy)\cdot i + (dx-bz)\cdot j + (by-cx)\cdot k\\
                    = (aw - \langle u,v\rangle) + (a\cdot v + w\cdot u + u \times v)
                    \end{eqnarray}
                    $$
                    (\(\langle u,v\rangle\) l√† t√≠ch v√¥ h∆∞·ªõng c·ªßa \(u\) v√† \(v\))<br/>
                    Nh∆∞ v·∫≠y ta c√≥ th·ªÉ th·ª±c hi·ªán ph√©p nh√¢n 2 Quaternion b·∫±ng c√°c ph√©p t√≠nh v·ªõi vector 3D (t√≠ch v√¥ h∆∞·ªõng, t√≠ch c√≥ h∆∞·ªõng) v√† scalar. ƒêi·ªÅu n√†y s·∫Ω ƒë∆°n gi·∫£n h√≥a
                    m·ªçi th·ª© ta mu·ªën l√†m v·ªÅ sau.<br/><br/>

                    <h2>4. Li√™n h·ª£p (Conjugate) v√† chi·ªÅu d√†i c·ªßa Quaternion</h2>
                    B·∫°n ƒë√£ h·ªçc h·ªìi c·∫•p 2, li√™n h·ª£p c·ªßa 1 bi·ªÉu th·ª©c \(a + b\) l√† \(a - b\). Trong Quaternion c≈©ng t∆∞∆°ng t·ª±, li√™n h·ª£p c·ªßa Quaternion \(q = a + v\) l√† \(q^* = a - v\), kh√¥ng
                    v√¨ l√≠ do g√¨ c·∫£, ta t√≠nh th·ª≠ \(q\cdot q^*\) (s·ª≠ d·ª•ng ph√©p nh√¢n scalar-vector ta ƒë√£ ch·ª©ng minh ƒë∆∞·ª£c ·ªü tr√™n):
                    $$
                        (a+u)\cdot(a-u) = (a^2 - \langle u,-u\rangle) + (au-au+u\times(-u)) = (a^2+\langle u,u \rangle) + 0 = a^2 + |u|^2
                    $$
                    (T√≠ch v√¥ h∆∞·ªõng ƒë·ªïi d·∫•u khi ƒë·ªïi chi·ªÅu 1 vector, t√≠ch c√≥ h∆∞·ªõng = 0 khi 2 vector c√πng ph∆∞∆°ng, t√≠ch v√¥ h∆∞·ªõng c·ªßa 2 vector gi·ªëng nhau ra ƒë·ªô d√†i c·ªßa vector ƒë√≥ * 2).<br/>
                    N·∫øu b·∫°n vi·∫øt l·∫°i Quaternion k·∫øt qu·∫£ ra d·∫°ng s·ªë ph·ª©c m·ªü r·ªông, b·∫°n s·∫Ω th·∫•y m·ªôt th·ª© quen thu·ªôc:
                    $$
                        a^2 + |u|^2 = a^2 + x^2 + y^2 + z^2
                    $$
                    N√≥ ch√≠nh l√† c√¥ng th·ª©c chi·ªÅu d√†i c·ªßa vector 4 chi·ªÅu b√¨nh ph∆∞∆°ng, suy ra ta c√≥ c√¥ng th·ª©c sau:
                    $$
                    |q|^2 = q\cdot q^*
                    $$
                    Ngo√†i t√≠nh ƒë∆∞·ª£c chi·ªÅu d√†i Quaternion, li√™n h·ª£p c√≤n c√≥ c√°c t√≠nh ch·∫•t sau:
                    $$
                    (q^*)^*=q
                    $$
                    (ƒë·ªïi chi·ªÅu ph·∫ßn vector \(u\) xong ƒë·ªïi chi·ªÅu l·∫ßn n·ªØa n√≥ s·∫Ω ra l·∫°i vector ban ƒë·∫ßu)<br/>
                    Th·ª≠ d√πng c√¥ng th·ª©c chi·ªÅu d√†i Quaternion l√™n \(q^*\):
                    $$
                        |q*|^2=q^* \cdot (q^*)^* = q^* \cdot q
                    $$
                    Ta c≈©ng th·ª≠ d√πng c√¥ng th·ª©c nh√¢n Quaternion v·ªõi \(|q^*|^2\):
                    $$
                        |q^*|^2 = a^2 + \langle -u,-u \rangle + 0 = a^2 + (-x)^2 + (-y)^2 + (-z)^2 = a^2+x^2+y^2+z^2 = |q|^2
                    $$
                    T·ª´ ƒë√≥ ta suy ra ƒë∆∞·ª£c:
                    $$
                        q\cdot q^* = |q|^2 = |q^*|^2 = q^*\cdot q
                    $$
                    Suy ra t√≠ch \(q\cdot q^*\) c√≥ t√≠nh ch·∫•t giao ho√°n, v√† chi·ªÅu d√†i c·ªßa li√™n h·ª£p c·ªßa Quaternion b·∫±ng chi·ªÅu d√†i c·ªßa ch√≠nh Quaternion ƒë√≥ üò≥

                    <h2>5. Li√™n h·ª£p v√† chi·ªÅu d√†i c·ªßa t√≠ch Quaternion</h2>
                    T√≠nh ƒë∆∞·ª£c li√™n h·ª£p c·ªßa t√≠ch Quaternion c≈©ng kh√° l√† h·ªØu d·ª•ng, cho n√™n sau ƒë√¢y ta s·∫Ω c√πng nhau t√≠nh n√≥ üò≥
                    (<a href="https://lisyarus.github.io/blog/posts/introduction-to-quaternions.html#section-conjugate-and-length-of-a-product">Blog c·ªßa lisyarus</a> kh√¥ng t√≠nh m√† ch·ªâ k√™u m√¨nh
                    "t·ª± nh√¢n s·∫Ω th·∫•y"):
                    $$
                    \begin{eqnarray} 
                    (p\cdot q)^* \\
                    = ((aw - \langle u,v\rangle) + (a\cdot v + w\cdot u + u \times v))^* \\
                    = (aw - \langle u,v\rangle) - (a\cdot v + w\cdot u + u \times v)\\
                    = (wa - \langle v,u\rangle) + (-w\cdot u - a\cdot v - u \times v) \\
                    = (wa - \langle -v,-u\rangle) + (w\cdot (-u) + a \cdot (-v) + v \times u) \\
                    = (wa - \langle -v,-u\rangle) + (w\cdot (-u) + a \cdot (-v) + (-v) \times (-u)) \\
                    = (w - v) \cdot (a - u)
                    \end{eqnarray}
                    $$
                    Nh∆∞ v·∫≠y: \((p\cdot q)^* = q^* \cdot p^*\)<br/>
                    Ti·∫øp theo ta th·ª≠ t√≠nh chi·ªÅu d√†i c·ªßa 1 t√≠ch Quaternion:
                    $$
                        |p\cdot q|^2 = (p\cdot q)\cdot (p\cdot q)^* = (p\cdot q)\cdot(q^*\cdot p^*) = \\
                            = p\cdot (q\cdot q^*)\cdot p^* = p\cdot |q|^2 \cdot p^* = |q|^2 p\cdot p^* = |q|^2 |p|^2
                    $$
                    ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† chi·ªÅu d√†i c·ªßa t√≠ch l√† t√≠ch c·ªßa chi·ªÅu d√†i üò≥<br/>
                    Hai th·ª© ta v·ª´a ch·ª©ng minh ·ªü tr√™n c≈©ng √°p d·ª•ng cho \(n\) Quaternion, v√¨ Quaternion c√≥ t√≠nh ch·∫•t k·∫øt h·ª£p:
                    $$
                        (p_1\cdot p_2\cdot\dots\cdot p_n)^* = p_n^*\cdot\dots\cdot p_2^* \cdot p_1^*
                    $$
                    $$
                        |p_1\cdot\dots\cdot p_n| = |p_1|\cdot\dots\cdot|p_n|
                    $$
                    <h2>6. Tr√≠ch xu·∫•t ph·∫ßn scalar v√† vector c·ªßa Quaternion</h2>
                    Ta c√≥ th·ªÉ tr√≠ch xu·∫•t ph·∫ßn scalar v√† vector c·ªßa Quaternion b·∫±ng c·ªông tr·ª´ v·ªõi li√™n h·ª£p:
                    $$
                    q+q^* = (a+u) + (a-u) = 2a \Rightarrow a = \frac{q+q^*}{2}
                    $$
                    $$
                    q-q^* = (a+u) - (a-u) = 2u \Rightarrow u = \frac{q-q^*}{2}
                    $$
                    Ngo√†i ra ta c≈©ng c√≥ th·ªÉ ch·ª©ng minh n·∫øu m·ªôt Quaternion l√† thu·∫ßn scalar hay thu·∫ßn vector, thu·∫ßn scalar th√¨ ph·∫ßn vector = 0, thu·∫ßn vector th√¨ ph·∫ßn scalar = 0:
                    $$
                    q-q^*=0 \Longleftrightarrow q^*=q
                    $$
                    $$
                    q+q^*=0 \Longleftrightarrow q^*=-q
                    $$
                    <h2>7. T√≠ch v√¥ h∆∞·ªõng v·ªõi Quaternion</h2>
                    ƒê·∫∑t 2 Quaternion \(p=a+u=(a,b,c,d)\) v√† \(q=w+v=(w,x,y,z)\), ta th·ª≠ t√≠nh t√≠ch v√¥ h∆∞·ªõng c·ªßa 2 Quaternion d∆∞·ªõi d·∫°ng vector 4 chi·ªÅu:
                    $$
                    (a,b,c,d)\cdot(w,x,y,z) = aw+bx+cy+dz = aw+\langle u,v\rangle = aw-\langle u,-v\rangle
                    $$
                    N·∫øu b·∫°n nh√¨n l·∫°i ph√©p nh√¢n c·ªßa ph√©p bi·ªÉu di·ªÖn scalar-quaternion, th√¨ ƒë√≥ ch√≠nh l√† ph·∫ßn scalar c·ªßa ph√©p nh√¢n \((a+u)\cdot(w-v) = p\cdot q^*\)! S·ª≠ d·ª•ng
                    l·∫°i c√¥ng th·ª©c tr√≠ch xu·∫•t ph·∫ßn scalar ·ªü ph·∫ßn 6, ta c√≥:
                    $$
                    \langle p,q \rangle = \frac{p\cdot q^* + (p\cdot q^*)^*}{2} = \frac{1}{2}\left(p\cdot q^* + q\cdot p^*\right)
                    $$
                    B√¢y gi·ªù gi·∫£ s·ª≠ \(p, q\) ƒë·ªÅu l√† Quaternion thu·∫ßn vector, ƒë·ªìng nghƒ©a \(p^* = -p, q^* = -q\):
                    $$
                    \langle p,q \rangle = \frac{1}{2}\left(p\cdot q^* + q\cdot p^*\right) = \frac{1}{2}\left(p\cdot (-q) + q\cdot (-p)\right) = -\frac{1}{2}(p\cdot q + q\cdot p)
                    =-\frac{1}{2}(u\cdot v + v\cdot u)
                    $$
                    <h2 id="crossproduct">8. T√≠ch c√≥ h∆∞·ªõng v·ªõi Quaternion</h2>
                    Ta l·∫°i gi·∫£ s·ª≠ \(p, q\) ƒë·ªÅu l√† Quaternion thu·∫ßn vector, ta th·ª≠ nh√¢n 2 Quaternion n√†y:
                    $$
                    p\cdot q = (0 - \langle u, v\rangle) + (0 + 0 + u\times v) = -\langle u, v\rangle + u\times v 
                    $$
                    \(u\times v\) ch√≠nh l√† ph·∫ßn vector c·ªßa \(p\cdot q\), s·ª≠ d·ª•ng c√¥ng th·ª©c tr√≠ch xu·∫•t ph·∫ßn vector:
                    $$
                    u\times v = \frac{p\cdot q - (p\cdot q)^*}{2} = \frac{p\cdot q - q^*\cdot p^*}{2} = \frac{p\cdot q - (-q)\cdot (-p)}{2} = \frac{1}{2}(p\cdot q - q\cdot p)
                    = \frac{1}{2}(u\cdot v - v\cdot u)
                    $$
                    <i>L∆∞u √Ω: N·∫øu b·∫°n so s√°nh v·ªõi ph·∫ßn n√†y c·ªßa <a href="https://lisyarus.github.io/blog/posts/introduction-to-quaternions.html#section-cross-product-via-conjugation">Blog c·ªßa lisyarus</a>,
                    b·∫°n s·∫Ω th·∫•y n√≥ b·ªã ng∆∞·ª£c nhau, ƒë√≥ l√† v√¨ t·ª± nhi√™n lisyarus v√¨ m·ªôt l√≠ do n√†o ƒë√≥ ƒë·∫∑t \(p=v\) v√† \(q=u\), ng∆∞·ª£c l·∫°i v·ªõi nh·ªØng g√¨ t·ª´ ƒë·∫ßu t·ªõi gi·ªù</i>

                    <h2>9. V√¨ sao Quaternion li√™n quan t·ªõi xoay 3D</h2>
                    Cu·ªëi c√πng ta c≈©ng ƒë√£ t·ªõi ph·∫ßn ch√≠nh b√†i blog n√†y, t·ªõi ƒë∆∞·ª£c l√≠ do m√† ta ph·∫£i lƒÉn l·ªôn v·ªõi m·ªôt ƒë·ªëng to√°n 4D ü•µ<br/>
                    Ta c·∫ßn t√¨m m·ªôt c√¥ng th·ª©c Quaternion c√≥ t√≠nh ch·∫•t y h·ªát m·ªôt ph√©p xoay 3D, nghƒ©a l√† c√¥ng th·ª©c ƒë√≥ ph·∫£i:
                    <ol>
                        <li>Chuy·ªÉn m·ªôt vector th√†nh m·ªôt vector</li>
                        <li>Gi·ªØ nguy√™n chi·ªÅu d√†i c·ªßa vector ƒë√≥</li>
                        <li>Chuy·ªÉn 2 vector th√†nh 2 vector m·ªõi, 2 vector ƒë√≥ ph·∫£i gi·ªØ nguy√™n t√≠ch v√¥ h∆∞·ªõng</li>
                        <li>Chuy·ªÉn 2 vector th√†nh 2 vector m·ªõi, t√≠ch c√≥ h∆∞·ªõng c·ªßa 2 vector c≈©ng ph·∫£i xoay t∆∞∆°ng t·ª± nh∆∞ 2 vector ƒë√≥</li>
                    </ol>
                    C√¥ng th·ª©c th·ªèa h·∫øt nh·ªØng ƒëi·ªÅu ki·ªán tr√™n ch√≠nh l√† \(u = q\cdot v\cdot q^*\), trong ƒë√≥ v l√† m·ªôt Quaternion thu·∫ßn vector (c≈©ng c√≥ th·ªÉ hi·ªÉu n√≥ l√† m·ªôt vector).
                    N√≥ t·ª´ ƒë√¢u ra, v√¨ sao ng∆∞·ªùi ta t√¨m ra n√≥? M√¨nh c≈©ng ch·∫£ bi·∫øt, nh∆∞ng c√°i m√¨nh c√≥ th·ªÉ l√†m l√† ch·ª©ng minh h·∫øt nh·ªØng ƒëi·ªÅu tr√™n üòÖ<br/><br/>
                    ƒê·∫ßu ti√™n ta c·∫ßn ch·ª©ng minh \(u\) c≈©ng l√† m·ªôt Quaternion thu·∫ßn vector (l√† m·ªôt vector), ƒëi·ªÅu n√†y ƒë√∫ng khi \(u^* = -u\):
                    $$
                        u^* = (q\cdot v\cdot q^*)^* = (q^*)^*\cdot v^*\cdot q^* = q\cdot (-v)\cdot q^* = -q\cdot v\cdot q^*=-u
                    $$
                    Ti·∫øp theo l√† chi·ªÅu d√†i:
                    $$
                        |u| = |q\cdot v\cdot q^*| = |q|\cdot|v|\cdot|q^*| = |q|\cdot|v|\cdot|q| = |q|^2\cdot|v|
                    $$
                    <div align="center" style="font-size:14px"><i>(Chi·ªÅu d√†i t√≠ch b·∫±ng t√≠ch chi·ªÅu d√†i, chi·ªÅu d√†i li√™n h·ª£p q b·∫±ng chi·ªÅu d√†i q)</i></div>
                    Nh∆∞ v·∫≠y n·∫øu chi·ªÅu d√†i c·ªßa \(q = 1\), th√¨ c√¥ng th·ª©c \(q\cdot v\cdot q^*\) s·∫Ω gi·ªØ nguy√™n chi·ªÅu d√†i \(v\). Nh∆∞ v·∫≠y ta s·∫Ω b·∫Øt ƒë·∫ßu r√†ng bu·ªôc Quaternion trong c√¥ng th·ª©c
                    \(q\cdot v\cdot q^*\) l√† m·ªôt Quaternion ƒë∆°n v·ªã (chi·ªÅu d√†i b·∫±ng 1) t·ª´ b∆∞·ªõc n√†y<br/><br/>
                    Ti·∫øp theo l√† t·ªõi t√≠ch v√¥ h∆∞·ªõng:
                    $$
                    \begin{eqnarray}
                    \langle pvp^*, pup^* \rangle
                    = -\frac{1}{2}\left((pvp^*)\cdot(pup^*)+(pup^*)\cdot(pvp^*)\right) \\
                    = -\frac{1}{2}\left(pv(p^*p)up^* + pu(p^*p)vp^*\right) \\
                    = -\frac{1}{2}\left(pv\cdot |p|^2\cdot up^* + pu\cdot |p|^2 \cdot vp^*\right) \\
                    = -\frac{1}{2}\left(pvup^*+puvp^*\right) \\
                    = -\frac{1}{2}\left(p(vu)p^*+p(uv)p^*\right) \\
                    = -p\frac{1}{2}\left(vu + uv\right)p^* \\
                    = p\cdot\langle v,u\rangle\cdot p^* \\
                    = \langle v,u\rangle\cdot p\cdot p^* \\
                    = \langle v,u\rangle \cdot |p|^2 \\
                    = \langle v,u\rangle
                    \end{eqnarray}
                    $$
                    Nh∆∞ v·∫≠y ph√©p t√≠nh \(q\cdot v\cdot q^*\) gi·ªØ nguy√™n t√≠ch v√¥ h∆∞·ªõng.<br/><br/>

                    Cu·ªëi c√πng l√† ch·ª©ng minh xem n√≥ c√≥ bi·∫øn ƒë·ªïi t√≠ch c√≥ h∆∞·ªõng c·ªßa \(u, v\) nh∆∞ c√°ch n√≥ bi·∫øn ƒë·ªïi 2 vector \(u, v\) kh√¥ng. N√≥ s·∫Ω ƒë√∫ng khi t√≠ch c√≥ h∆∞·ªõng c·ªßa \(u, v\) l√∫c ƒë·∫ßu sau khi 
                    bi·∫øn ƒë·ªïi s·∫Ω b·∫±ng v·ªõi t√≠ch c√≥ h∆∞·ªõng c·ªßa 2 vector m·ªõi ƒë√£ bi·∫øn ƒë·ªïi, t·ª©c l√† ta c·∫ßn ch·ª©ng minh:
                    $$
                        p(u\times v)p^* = (pup^*)\times(pvp^*) (1)
                    $$
                    ƒê·∫ßu ti√™n ta x√©t ph√©p nh√¢n Quaternion b√¨nh th∆∞·ªùng:
                    $$
                        p(uv)p^* = (pup^*)(pvp^*) (2)
                    $$
                    D·ª±a v√†o t√≠nh ch·∫•t k·∫øt h·ª£p c·ªßa Quaternion, ta c√≥ v·∫ø ph·∫£i:
                    $$
                        (pup^*)(pvp^*) = pu(p^*p)vp^* = pu|p|^2vp^* = puvp^* = p(uv)p^*
                    $$
                    V·∫≠y l√† 2 v·∫ø tr√™n b·∫±ng nhau.<br/>
                    X√©t v·∫ø tr√°i c·ªßa (2), ta bi·∫øt ·ªü <a href="#crossproduct">ph·∫ßn 8</a> l√† k·∫øt qu·∫£ nh√¢n c·ªßa 2 Quaternion thu·∫ßn vector l√† \(-\langle u, v\rangle + u\times v\):
                    $$
                    p(uv)p^* = p(-\langle u, v\rangle + u\times v)p^* = p(-\langle u, v\rangle)p^*  + p(u\times v)p^* = (-\langle u, v\rangle)pp^* + p(u\times v)p^*
                    =-\langle u, v\rangle + p(u\times v)p^*
                    $$
                    Nh∆∞ v·∫≠y ph·∫ßn vector c·ªßa \(p(uv)p^*\) l√† \(p(u\times v)p^*\)<br/><br/>
                    V√¨ k·∫øt qu·∫£ nh√¢n 2 Quaternion thu·∫ßn vector \(uv = -\langle u, v\rangle + u\times v\), suy ra ph·∫ßn vector c·ªßa m·ªôt t√≠ch Quaternion
                    thu·∫ßn vector l√† t√≠ch c√≥ h∆∞·ªõng c·ªßa ph·∫ßn vector c·ªßa 2 Quaternion ƒë√≥. \((pup^*)\) v√† \((pvp^*)\) ƒë·ªÅu ra k·∫øt qu·∫£ l√† m·ªôt Quaternion thu·∫ßn vector.
                    Suy ra ph·∫ßn vector c·ªßa \((pup^*)(pvp^*)\) l√† \((pup^*)\times(pvp^*)\).<br/><br/>

                    V√¨ \(p(uv)p^* = (pup^*)(pvp^*)\) n√™n ph·∫ßn vector c·ªßa ch√∫ng c≈©ng b·∫±ng nhau, suy ra \(p(u\times v)p^* = (pup^*)\times(pvp^*)\), ƒë√≥ ch√≠nh l√† (1), th·ª© m√† ta c·∫ßn ch·ª©ng minh üò≥<br/><br/>

                    C√°ch ch·ª©ng minh c·ªßa lisyarus s·ª≠ d·ª•ng 3 Quaternion c∆° b·∫£n \(i, j, k\), m√† nghe n√≥ kh√° m∆° h·ªì, ch·∫Øc ph·∫£i ng·∫ßm hi·ªÉu nhi·ªÅu th·ª© v√† m·ªôt ng∆∞·ªùi l√†m vi·ªác v·ªõi to√°n
                    l√¢u nƒÉm m·ªõi ng·∫ßm hi·ªÉu ƒë∆∞·ª£c. N√™n m√¨nh ch·ª©ng minh b·∫±ng c√°ch d√†i th√≤n l√≤n ·ªü tr√™n cho b·∫°n th·∫•y r√µ h∆°n ü•µ

                    <h2>10. Xoay m·ªôt vector v·ªõi Quaternion</h2>
                    Sau khi lƒÉn l·ªôn th√™m m·ªôt ch√∫t th√¨ cu·ªëi c√πng ta ƒë√£ t·ªõi ƒë∆∞·ª£c th·ª© ta th·∫≠t s·ª± c·∫ßn ü•µ<br/>
                    Ta c·∫ßn bi·∫øt nh·ªØng th·ª© sau v·ªÅ ph√©p bi·∫øn ƒë·ªïi \(pvp^*\):
                    <ol>
                        <li>N√≥ xoay quanh tr·ª•c n√†o?</li>
                        <li>N√≥ xoay bao nhi√™u ƒë·ªô?</li>
                    </ol>
                    ƒê·∫∑t \(p=a+v\), ta th·ª≠ √°p d·ª•ng ph√©p bi·∫øn ƒë·ªïi tr√™n v·ªõi ch√≠nh ph·∫ßn vector \(v\) c·ªßa \(p\):
                    $$
                    pvp^* = (a+v)v(a-v) = (a+v)(a-v)v = pp^*v = |p|^2v = v
                    $$
                    <i>Nh·ªõ l√† \(p\) l√† m·ªôt Quaternion ƒë∆°n v·ªã, chi·ªÅu d√†i b·∫±ng 1</i><br/>
                    ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† ph√©p bi·∫øn ƒë·ªïi ƒë√≥ kh√¥ng thay ƒë·ªïi \(v\), nghƒ©a l√† xoay \(v\) xong n√≥ v·∫´n nh∆∞ c≈©, nghƒ©a l√† \(v\) song song v·ªõi tr·ª•c xoay v√† chi·ªÅu c·ªßa
                    \(v\) c≈©ng l√† chi·ªÅu c·ªßa tr·ª•c xoay.<br/><br/>
                    ƒê·ªÉ ƒë∆°n gi·∫£n h√≥a v·∫•n ƒë·ªÅ, ta x√©t th·ª≠ ph√©p xoay tr√™n m·∫∑t ph·∫≥ng \(XZ\) s·∫Ω ra sao, nghƒ©a l√† xoay quanh tr·ª•c \(Y\), khi ƒë√≥ \(v\) s·∫Ω c√πng ph∆∞∆°ng c√πng chi·ªÅu v·ªõi \(j\),
                    v√† Quaternion \(p\) c√≥ d·∫°ng:
                    $$
                        p = a+bj (1)
                    $$
                    Ta h√£y xem n√≥ l√†m g√¨ v·ªõi tr·ª•c \(X\), nghƒ©a l√† Quaternion \(i\):
                    $$
                    pip^* = (a+bj)i(a-bj) = (ai+bji)(a-bj) = (ai-bk)(a-bj) =
                         a^2i-abij-abk+b^2kj = a^2i - abk - abk - b^2i = (a^2-b^2)i - 2abk
                    $$
                    ·ªû <a href="graphics3D5-model.html">blog 5</a>, trong l√∫c ta ƒëang t√¨m rotation matrix, ta ƒë√£ bi·∫øt ·ªü 2D, khi xoay \(v\) m·ªôt g√≥c \(\theta\) th√†nh \(v'\),
                    th√¨ \(|\vec{v'_{x}}| = |v_x|\cos{Œ∏} - |v_y|\sin{Œ∏}\) v√† \(|\vec{v'_{y}}| = |v_x|\sin{Œ∏} + |v_y|\cos{Œ∏}\). Nh∆∞ v·∫≠y sau khi xoay xong \(i\), th√¨ \(i'\)
                    c√≥ \(i'_x = |i_x|\cos{Œ∏} - |i_y|\sin{Œ∏} = \cos{\theta}\) v√† \(i'_y = |i_x|\sin{Œ∏} + |i_y|\cos{Œ∏} = \sin{\theta}\). Nghƒ©a l√† \(i'\) c√≥ d·∫°ng:
                    $$
                        \cos\theta i + \sin\theta k
                    $$
                    N√≥ c√≥ c√πng d·∫°ng v·ªõi \((a^2-b^2)i-2abk\), suy ra:
                    $$
                        a^2-b^2 = \cos\theta \\
                    $$
                    $$
                        -2ab = \sin\theta
                    $$
                    C√≥ nhi·ªÅu c√°ch ƒë·ªÉ t√¨m ƒë∆∞·ª£c \(a, b\), c√°ch g·ªçn nh·∫•t l√† d√πng c√°c ph√©p t√≠nh l∆∞·ª£ng gi√°c m√† ta ƒë√£ h·ªçc h·ªìi c·∫•p 3, c·ª• th·ªÉ l√† \(\sin{(2\theta)} = 2\sin{\theta}\cos{\theta}\)
                    v√† \(\cos{(2\theta)} = \cos{\theta}^2 - \sin{\theta}^2\). Suy ra:
                    $$
                        a = \cos\frac{\theta}{2}
                    $$
                    $$
                        b = -\sin\frac{\theta}{2}
                    $$
                    Theo (1), suy ra \(p\) c√≥ d·∫°ng:
                    $$
                        p = \cos\frac{\theta}{2} - \sin\frac{\theta}{2}k
                    $$
                    ƒê√≥ ch·ªâ l√† ph√©p xoay xung quanh \(j\) - xung quanh tr·ª•c \(Y\), nh∆∞ng th·∫≠t ra ta c√≥ th·ªÉ ƒë·ªÉ b·∫•t k·ª≥ Quaternion ƒë∆°n v·ªã \(n\) n√†o v√†o v·ªã tr√≠ c·ªßa \(j\), g·ªçi n√≥ 
                    l√† tr·ª•c \(Y\) v√† t√¨m 2 tr·ª•c \(X\) \(Z\) c·ªßa tr·ª•c \(Y\) ƒë√≥ l√† c≈©ng s·∫Ω ra. Nh∆∞ v·∫≠y ta c√≥ Quaternion ƒë∆∞·ª£c d√πng trong ph√©p xoay g√≥c \(\theta\) xung quanh tr·ª•c c√πng chi·ªÅu v·ªõi vector \(n\) l√†:
                    $$
                        p = \cos\frac{\theta}{2} - \sin\frac{\theta}{2}n
                    $$
                    <i>B·∫°n ƒë·ªÉ √Ω l√† <a href="https://lisyarus.github.io/blog/posts/introduction-to-quaternions.html#section-constructing-specific-rotations">Blog c·ªßa lisyarus</a> d√πng 
                    v√≠ d·ª• l√† \(k\) ch·ª© kh√¥ng ph·∫£i \(j\), v√† ra k·∫øt qu·∫£ kh√°c m√¨nh, ƒë√≥ l√† v√¨ m√¨nh x√†i h·ªá t·ªça ƒë·ªô tay tr√°i (left-handed coordinate). N·∫øu b·∫°n nh·ªõ, ƒë√≥ c≈©ng l√† l√≠ do t·∫°i sao m√¨nh l·∫°i x√©t tr·ª•c \(y\)
                    tr∆∞·ªõc ·ªü <a href="graphics3D5-model.html">blog 5</a>.</i><br/><br/>
                    Theo <a href="https://en.wikipedia.org/wiki/Euler%27s_rotation_theorem">ƒë·ªãnh l√Ω xoay c·ªßa Euler</a>, s·ª± k·∫øt h·ª£p c·ªßa nhi·ªÅu ph√©p xoay ƒë·ªÅu ra k·∫øt qu·∫£ l√† m·ªôt ph√©p xoay quanh
                    m·ªôt tr·ª•c n√†o ƒë√≥ trong kh√¥ng gian, nghƒ©a l√† ph√©p xoay tr√™n c√≥ th·ªÉ ƒë·∫°i di·ªán cho m·ªçi ph√©p xoay trong kh√¥ng gian 3D. Gi·∫£ s·ª≠ ta mu·ªën xoay theo Quaternion \(q\), xong r·ªìi xoay theo Quaternion \(p\) n·ªØa th√¨ sao? Ta xem th·ª≠:
                    $$
                        p(qvq^*)p^* = (pq)v(q^*p^*) = (pq)v(pq)^*
                    $$
                    Nghƒ©a l√† th·ª±c hi·ªán ph√©p xoay c·ªßa \(q\) r·ªìi \(p\) c≈©ng gi·ªëng nh∆∞ th·ª±c hi·ªán 1 ph√©p xoay \(pq\) v·∫≠y üò≥ ƒê√¢y ch√≠nh l√† s·ª©c m·∫°nh c·ªßa Quaternion.

                    <div id="graphics3D-nav-bottom"></div>
                </div>

            </div>
        </div>
    </main>

    <footer></footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <script src="graphics3D.js"></script>
    <script src="/js/loadsidebar.js"></script>
</body>

</html>