<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@200&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/blogcontent.css">
    <link rel="stylesheet" href="/css/prism.css">
    <link rel="stylesheet" href="graphics3D.css">

    <script src="/js/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <title>Graphics Engine 3D</title>
</head>

<body data-graphics3D-id="graphics3D8">
    <main>
        <div class="container-fluid ps-0">
            <div class="row">
                <div class="col-12 col-lg-2 sidebar pb-0 pe-0">
                    <!--load from sidebar.html-->
                </div>

                <div class="blog-content col-12 col-lg-10">
                    <div id="graphics3D-nav-top"></div>
                    <h1>View matrix</h1>
                    
                    Ta s·∫Ω v·ªÅ l·∫°i v·ªõi ma tr·∫≠n sau m·ªôt blog kh·ªßng ho·∫£ng v·ªõi to√°n 4D ü•µ Blog n√†y kh√¥ng n·∫±m k·∫ø ti·∫øp blog model (ƒë·ªß b·ªô Model View Project matrix) l√† c√≥ l√≠ do c·∫£.<br/><br/>

                    T·ª´ ƒë·∫ßu t·ªõi gi·ªù ta ch·ªâ "ƒë√∫ng m·ªôt ch·ªó nh√¨n", render ƒë√∫ng 1 g√≥c nh√¨n ·ªü 1 v·ªã tr√≠ c·ªë ƒë·ªãnh (0, 0, 0), n·∫øu nh∆∞ ta mu·ªën "xoay ch·ªó kh√°c" hay "ƒëi ch·ªó kh√°c" th√¨ sao? ƒê√≥ ch√≠nh
                    l√† c√¥ng d·ª•ng c·ªßa View matrix, l√† ƒëi·ªÅu khi·ªÉn "camera" v√† hi·ªÉn th·ªã ƒë√∫ng nh·ªØng g√¨ m√† "camera" th·∫•y.<br/><br/>

                    ƒê·∫ßu ti√™n, ta ph·∫£i hi·ªÉu l√† View matrix kh√¥ng di chuy·ªÉn hay xoay camera, m√† th·∫≠t ra l√† ƒëang di chuy·ªÉn v√† xoay c·∫£ th·∫ø gi·ªõi quanh camera, camera v·∫´n lu√¥n ·ªü
                    (0, 0, 0) v√† lu√¥n nh√¨n theo tr·ª•c Z (n·∫øu l√† h·ªá t·ªça ƒë·ªô tay tr√°i). V√≠ d·ª• ta mu·ªën camera ·ªü v·ªã tr√≠ (0, 2, -5) v√† euler angles c·ªßa n√≥ l√† (30, -50, 40), ta ph·∫£i
                    di chuy·ªÉn to√†n b·ªô object (0, -2, 5) v√† xoay to√†n b·ªô object quanh g·ªëc t·ªça ƒë·ªô (ch·ª© ko ph·∫£i quanh t√¢m c·ªßa ch√≠nh n√≥) (-30, 50, -40) (xoay theo th·ª© t·ª± \(z \rightarrow
                    y \rightarrow x\), ng∆∞·ª£c v·ªõi l√∫c xoay object).<br/><br/>
                    
                    Theo v√≠ d·ª• ƒë√≥, view matrix ch·ªâ l√† k·∫øt qu·∫£ nh√¢n c·ªßa 3 rotation matrix v√† 1 translation matrix, g·ªçi v·ªã tr√≠ camera
                    l√† \(t\) v√† euler angles c·ªßa camera l√† \((\alpha, \beta, \gamma)\), view matrix s·∫Ω c√≥ d·∫°ng nh∆∞ sau:
                    $$
                        \begin{pmatrix}
                        1 & 0 & 0 & -t_{x}\\
                        0 & 1 & 0 & -t_{y}\\
                        0 & 0 & 1 & -t_{z}\\
                        0 & 0 & 0 & 1
                        \end{pmatrix}

                        \begin{pmatrix}
                        1 & 0 & 0 & 0\\
                        0 & cos{(-\alpha)} & sin{(-\alpha)} & 0\\
                        0 & -\sin{(-\alpha)} & \cos{(-\alpha)} & 0\\
                        0 & 0 & 0 & 1
                        \end{pmatrix}

                        \begin{pmatrix}
                        cos{(-\beta)} & 0 & -sin{(-\beta)} & 0\\
                        0 & 1 & 0 & 0\\
                        \sin{(-\beta)} & 0 & \cos{(-\beta)} & 0 \\
                        0 & 0 & 0 & 1
                        \end{pmatrix}
                        
                        \begin{pmatrix}
                        cos{(-\gamma)} & sin{(-\gamma)} & 0 & 0\\
                        -\sin{(-\gamma)} & \cos{(-\gamma)} & 0 & 0\\
                        0 & 0 & 1 & 0\\
                        0 & 0 & 0 & 1
                        \end{pmatrix}
                    $$
                    $$
                        =
                        \begin{pmatrix}
                        \cos\beta\cos\gamma &
                        -\cos\beta\sin\gamma &
                        \sin\beta &
                        - t_x \\[6pt]

                        \sin\alpha\sin\beta\cos\gamma+\cos\alpha\sin\gamma &
                        -\sin\alpha\sin\beta\sin\gamma+\cos\alpha\cos\gamma &
                        -\sin\alpha\cos\beta &
                        - t_y \\[6pt]

                        -\cos\alpha\sin\beta\cos\gamma+\sin\alpha\sin\gamma &
                        \cos\alpha\sin\beta\sin\gamma+\sin\alpha\cos\gamma &
                        \cos\alpha\cos\beta &
                        - t_z \\[6pt]

                        0 & 0 & 0 & 1
                        \end{pmatrix}
                    $$
                    <div align="center" style="font-size: 14px"><i>M√¨nh d√πng ChatGPT ƒë·ªÉ ra ƒë∆∞·ª£c k·∫øt qu·∫£ tr√™n v√¨ nh√¢n b·∫±ng tay ch·∫Øc t·ªõi mai ü•µ</i></div><br/>
                    N·∫øu b·∫°n mu·ªën, b·∫°n c√≥ th·ªÉ x√†i lu√¥n ma tr·∫≠n ƒë√≥ v√†o trong engine, v√† n√≥ s·∫Ω ch·∫°y ƒë√∫ng. Nh∆∞ng trong ƒë·ªì h·ªça 3D th√¨ kh√¥ng ai bi·ªÉu di·ªÖn view matrix v·ªõi euler angles c·∫£, m√†
                    thay v√†o ƒë√≥ ng∆∞·ªùi ta s·∫Ω d√πng 3 vector ƒë∆°n v·ªã ƒë·∫°i di·ªán cho tr·ª•c local c·ªßa camera, g·ªçi l√† forward (\(\vec{f}\)), up (\(\vec{u}\)) v√† right (\(\vec{r}\)).
                    Th·∫≠t ra b·∫°n c√≥ th·ªÉ chuy·ªÉn ma tr·∫≠n tr√™n th√†nh ma tr·∫≠n ch·ªâ c√≥ forward, up, right n·∫øu b·∫°n ƒë·ªß ki√™n nh·∫´n ƒë·ªÉ l√†m l∆∞·ª£ng gi√°c v·ªõi kh√¥ng gian 3D.<br/><br/>
                    Ta s·∫Ω l√†m t·ª´ 2D tr∆∞·ªõc ƒë·ªÉ d·ªÖ h√¨nh dung, trong 2D th√¨ camera ch·ªâ c√≤n up v√† right. Tr∆∞·ªõc ti√™n ta s·∫Ω x√©t rotation, ·ªü <a href="graphics3D5-model.html">blog 5</a>
                    ta bi·∫øt l√† khi xoay 1 vector \(\vec{v}\) 1 g√≥c \(\theta\) th√¨ s·∫Ω ra \(\vec{v'}\) v·ªõi \(v'_{x} = v_x\cos{Œ∏} - v_y\sin{Œ∏}\) v√† \(v'_{y} = v_x\sin{Œ∏} + v_y\cos{Œ∏}\). V√† ta c≈©ng bi·∫øt
                    khi xoay vector ƒë∆°n v·ªã c√πng chi·ªÅu v·ªõi tr·ª•c \(x, y\) (ch√≠nh l√† \(\vec{r}\) v√† \(\vec{u}\)) m·ªôt g√≥c \(\theta\) s·∫Ω ra 
                    \(\vec{r'}=(\cos{Œ∏}, \sin{Œ∏})\) v√† \(\vec{u'}=(-\sin{Œ∏}, \cos{Œ∏})\). Nh∆∞ v·∫≠y ta c√≥:
                    $$
                        v'_x = v_x\cos{Œ∏} - v_y\sin{Œ∏} = v_x.r'_x - v_y.r'_y
                        $$
                        $$
                        v'_y = v_x\sin{Œ∏} + v_y\cos{Œ∏} = -v_x.u'_x + v_y.u'_y
                    $$
                    Nh√¨n g·∫ßn gi·ªëng g√¨ ƒë√≥ m√† ch·∫£ gi·ªëng g√¨ c·∫£, nh∆∞ng b·∫°n ƒë·ªÉ √Ω l√† n√£y gi·ªù m√¨nh ƒëang mu·ªën xoay camera, trong khi th·ª© ta th·∫≠t s·ª± c·∫ßn l√†m l√† xoay th·∫ø gi·ªõi quanh camera.
                    Nh∆∞ v·∫≠y ta ph·∫£i xoay ng∆∞·ª£c l·∫°i l√† \(-\theta\), suy ra \(r'_y\) v√† \(u'_x\) s·∫Ω ƒë·ªïi d·∫•u (v√¨ l√† sin). Hai ph∆∞∆°ng tr√¨nh tr√™n th√†nh:
                    $$
                        v'_x = v_x.r'_x + v_y.r'_y
                        $$
                        $$
                        v'_y = v_x.u'_x + v_y.u'_y
                    $$
                    ƒê√≥ ch√≠nh l√† c√¥ng th·ª©c t√≠ch v√¥ h∆∞·ªõng üò≥ Th·∫≠t ra m√¨nh c≈©ng ƒëang v√≤ng vo over-explain gi·ªëng nh∆∞ <a href="graphics3D5-model.html">blog 5</a>, n·∫øu b·∫°n hi·ªÉu b·∫£n
                    ch·∫•t c·ªßa t√≠ch v√¥ h∆∞·ªõng th√¨ n√≥ s·∫Ω kh√° hi·ªÉn nhi√™n v√† d·ªÖ suy ra. Nh∆∞ v·∫≠y rotation matrix trong 2D c√≥ c√°ch vi·∫øt th·ª© 2 l√†:
                    $$
                    \begin{pmatrix}
                    r'_x & r'_y\\
                    u'_x & u'_y
                    \end{pmatrix}
                    $$
                    Th·∫≠t ra m√¨nh c√≥ th·ªÉ n√≥i lu√¥n l√† khi qua 3D, n√≥ s·∫Ω theo ƒë√∫ng quy lu·∫≠t v√† hi·ªÉn nhi√™n s·∫Ω th√†nh:
                    $$
                    \begin{pmatrix}
                    r'_x & r'_y & r'_z\\
                    u'_x & u'_y & u'_z\\
                    f'_x & f'_y & f'_z
                    \end{pmatrix}
                    $$
                    ƒê√≥ c≈©ng ch√≠nh l√† c√°ch m√† javidx9 "gi·∫£i th√≠ch", nh∆∞ng m√† ƒë·ªëi v·ªõi m√¨nh th√¨ kh√° kh√≥ ch·ªãu, gotta ask HOW, HOW does it become like that? C√°ch t·ªët nh·∫•t ƒë·ªÉ ch·ª©ng minh 
                    l√† xoay 3 vector c√πng chi·ªÅu v·ªõi tr·ª•c theo th·ª© t·ª± \(z \rightarrow y \rightarrow x\) (ng∆∞·ª£c v·ªõi xoay object, m√¨nh ƒë√£ n√≥i ·ªü tr√™n) xem n√≥ th√†nh g√¨.
                    ƒê·∫ßu ti√™n ta c√≥:
                    $$
                    \begin{eqnarray}
                    r = (1, 0, 0)\\
                    u = (0, 1, 0)\\
                    f = (0, 0, 1)
                    \end{eqnarray}
                    $$
                    Xoay theo tr·ª•c \(z\), l√† nh√¢n cho z rotation matrix:
                    $$
                        \begin{pmatrix}
                        cos{\gamma} & sin{\gamma} & 0\\
                        -\sin{\gamma} & \cos{\gamma} & 0 \\
                        0 & 0 & 1 \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        1\\
                        0\\
                        0
                        \end{pmatrix}=
                        \begin{pmatrix}
                        cos{\gamma}\\
                        -\sin{\gamma}\\
                        0
                        \end{pmatrix}
                    $$
                    $$
                        \begin{pmatrix}
                        cos{\gamma} & sin{\gamma} & 0\\
                        -\sin{\gamma} & \cos{\gamma} & 0 \\
                        0 & 0 & 1 \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        0\\
                        1\\
                        0
                        \end{pmatrix}=
                        \begin{pmatrix}
                        \sin{\gamma}\\
                        \cos{\gamma}\\
                        0
                        \end{pmatrix}
                    $$
                    $$
                        \begin{pmatrix}
                        cos{\gamma} & sin{\gamma} & 0\\
                        -\sin{\gamma} & \cos{\gamma} & 0 \\
                        0 & 0 & 1 \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        0\\
                        0\\
                        1
                        \end{pmatrix}=
                        \begin{pmatrix}
                        0\\
                        0\\
                        1
                        \end{pmatrix}
                    $$
                    Xoay theo tr·ª•c \(y\):
                    $$
                        \begin{pmatrix}
                        cos{\beta} & 0 & -sin{\beta}\\
                        0 & 1 & 0 \\
                        \sin{\beta} & 0 & \cos{\beta} \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        cos{\gamma}\\
                        -\sin{\gamma}\\
                        0
                        \end{pmatrix}=
                        \begin{pmatrix}
                        \cos{\beta}\cos{\gamma}\\
                        -\sin{\gamma}\\
                        \sin{\beta}\cos{\gamma}
                        \end{pmatrix}
                    $$
                    $$
                        \begin{pmatrix}
                        cos{\beta} & 0 & -sin{\beta}\\
                        0 & 1 & 0 \\
                        \sin{\beta} & 0 & \cos{\beta} \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        \sin{\gamma}\\
                        \cos{\gamma}\\
                        0
                        \end{pmatrix}=
                        \begin{pmatrix}
                        \cos{\beta}\sin{\gamma}\\
                        \cos{\gamma}\\
                        \sin{\beta}\sin{\gamma}
                        \end{pmatrix}
                    $$
                    $$
                        \begin{pmatrix}
                        cos{\beta} & 0 & -sin{\beta}\\
                        0 & 1 & 0 \\
                        \sin{\beta} & 0 & \cos{\beta} \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        0\\
                        0\\
                        1
                        \end{pmatrix}=
                        \begin{pmatrix}
                        -\sin{\beta}\\
                        0\\
                        \cos{\beta}
                        \end{pmatrix}
                    $$
                    Xoay theo tr·ª•c x:
                    $$
                        \begin{pmatrix}
                        1 & 0 & 0\\
                        0 & cos{\alpha} & sin{\alpha} \\
                        0 & -\sin{\alpha} & \cos{\alpha} \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        \cos{\beta}\cos{\gamma}\\
                        -\sin{\gamma}\\
                        \sin{\beta}\cos{\gamma}
                        \end{pmatrix}=
                        \begin{pmatrix}
                        \cos\beta\cos\gamma \\
                        -\cos\alpha\sin\gamma + \sin\alpha\sin\beta\cos\gamma \\
                        \sin\alpha\sin\gamma + \cos\alpha\sin\beta\cos\gamma
                        \end{pmatrix}
                    $$
                    $$
                        \begin{pmatrix}
                        1 & 0 & 0\\
                        0 & cos{\alpha} & sin{\alpha} \\
                        0 & -\sin{\alpha} & \cos{\alpha} \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        \cos{\beta}\sin{\gamma}\\
                        \cos{\gamma}\\
                        \sin{\beta}\sin{\gamma}
                        \end{pmatrix}=
                        \begin{pmatrix}
                        \cos\beta\sin\gamma \\
                        \cos\alpha\cos\gamma + \sin\alpha\sin\beta\sin\gamma \\
                        -\sin\alpha\cos\gamma + \cos\alpha\sin\beta\sin\gamma
                        \end{pmatrix}
                    $$
                    $$
                        \begin{pmatrix}
                        1 & 0 & 0\\
                        0 & cos{\alpha} & sin{\alpha} \\
                        0 & -\sin{\alpha} & \cos{\alpha} \\
                        \end{pmatrix}
                        \begin{pmatrix}
                        -\sin{\beta}\\
                        0\\
                        \cos{\beta}
                        \end{pmatrix}=
                        \begin{pmatrix}
                        -\sin\beta \\
                        \sin\alpha\cos\beta \\
                        \cos\alpha\cos\beta
                        \end{pmatrix}
                    $$
                    Nh∆∞ v·∫≠y:
                    $$
                    r' = \begin{pmatrix}
                        \cos\beta\cos\gamma \\
                        -\cos\alpha\sin\gamma + \sin\alpha\sin\beta\cos\gamma \\
                        \sin\alpha\sin\gamma + \cos\alpha\sin\beta\cos\gamma
                        \end{pmatrix}
                    $$
                    $$
                    u' = \begin{pmatrix}
                        \cos\beta\sin\gamma \\
                        \cos\alpha\cos\gamma + \sin\alpha\sin\beta\sin\gamma \\
                        -\sin\alpha\cos\gamma + \cos\alpha\sin\beta\sin\gamma
                        \end{pmatrix}
                    $$
                    $$
                    f' = \begin{pmatrix}
                        -\sin\beta \\
                        \sin\alpha\cos\beta \\
                        \cos\alpha\cos\beta
                        \end{pmatrix}
                    $$
                    
                    <div id="graphics3D-nav-bottom"></div>
                </div>

            </div>
        </div>
    </main>

    <footer></footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <script src="graphics3D.js"></script>
    <script src="/js/loadsidebar.js"></script>
</body>

</html>